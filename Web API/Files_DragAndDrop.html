<!DOCTYPE html>
<html>

<head>
  <style>
    #drop-div {
      width: 100px;
      height: 100px;
      border: 1px solid;
    }
  </style>
</head>

<body>
  <div>
    <h3>Single File</h3>
    <input type="file" id="file-single" />
    <p id="text-preview">File content will appear here.</p>
    <script>
      document
        .getElementById("file-single")
        .addEventListener("change", (event) => {
          const file = event.target.files[0];
          const textPreviewElement = document.getElementById("text-preview");

          const reader = new FileReader();

          // Start the asynchronous read operation
          reader.readAsText(file);

          // Handle completion
          reader.onload = () => {
            const content = reader.result.toString().trim();
            textPreviewElement.textContent = content;
          };

          // Handle errors
          reader.onerror = () => {
            console.error("Error reading file:", reader.error);
            textPreviewElement.textContent = "Error reading file.";
          };
        });
    </script>
  </div>

  <div>
    <h3>Multiple Files</h3>
    <input type="file" id="file-selector-multiple" multiple />

    <script>
      function readFileAsText(file) {
        return new Promise(function (resolve, reject) {
          let reader = new FileReader();
          reader.onload = function () {
            resolve(reader.result);
          };
          reader.onerror = function () {
            reject(reader);
          };
          reader.readAsText(file);
        });
      }

      document
        .getElementById("file-selector-multiple")
        .addEventListener("change", async (e) => {
          const files = e.currentTarget.files;
          const readers = Array.from(files).map(file => readFileAsText(file));
          const contents = await Promise.all(readers);
          console.log("All file contents loaded:", contents);
        });
    </script>
  </div>
  <div>
    <h3>Drag and Drop Image</h3>
    <div id="drop-div" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)"></div>
    <img id="drag-img" src="../assets/MSFT.png" draggable="true" ondragstart="dragStartHandler(event)" width="100"
      height="100" />
    <script>
      function dragStartHandler(ev) {
        // Add the target element's id to the data transfer object.
        ev.dataTransfer.setData("text/plain", ev.target.id);
      }
      function dragOverHandler(ev) {
        // Prevent default behavior to allow drop.
        ev.preventDefault();
      }
      function dropHandler(ev) {
        ev.preventDefault();
        // Retrieve the ID of the dragged element
        var data = ev.dataTransfer.getData("text/plain");
        ev.target.appendChild(document.getElementById(data));
      }
    </script>
  </div>

  <div>
    <h3>Drag and Drop Files</h3>
    <div id="drop_zone" style="border: 1px dotted red" ondrop="dropHandler(event);"
      ondragover="dragOverHandler(event);">
      <p>Drag one or more files to this drop zone.</p>
    </div>
    <script>
      function dropHandler(e) {
        e.preventDefault(); //Prevent file from being opened
        if (e.dataTransfer.items) {
          [...e.dataTransfer.items].forEach((item, i) => { //e.dataTransfer.items is a Iterable but not an Array
            if (item.kind === "file") { //If dropped items are files
              const file = item.getAsFile();
              console.log(`â€¦ file[${i}].name = ${file.name}`);
            }
          });
        }
      }

      function dragOverHandler(e) {
        e.preventDefault();

      }
    </script>
  </div>
</body>

</html>